<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>24-3</title>
    <style>
        h5{
            color: #ccc;
        }
    </style>
</head>
<body>
    <form action="">
        <h3>注册</h3>
        用户名 <input type="text" placeholder="用户名（hunger被注册过）" name="usename" id="usename">
        <h5 class="usename">只能是字母、数字、下划线，3-10个字符</h5>
        密码 <input type="text" placeholder="请输入密码" name="password" id="password">
        <h5 class="password">大写字母、小写、数字、下划线最少两种，6-15个字符</h5>
        再输一次 <input type="text" placeholder="请再输入一次密码" name="password_agin" id="password_agin">
        <h5 class="password_agin">  &nbsp;&nbsp; </h5>
        <button id="submit">注册</button>
    </form>
    <script>

        document.querySelector('#usename').addEventListener('change', function(){
            var xhr=new XMLHttpRequest();
            xhr.onreadystatechange=function() {
                if (xhr.readyState == 4 && xhr.status == 200) {
                    if (xhr.responseText==1){
                        document.getElementsByClassName("usename")[0].innerText="用户名已存在";
                    }
                    else if (2< document.getElementById("usename").value.toString().length && document.getElementById("usename").value.toString().length<11){
                        if (document.getElementById("usename").value.toString().match(/^\w{3,10}$/)) {
                            document.getElementsByClassName("usename")[0].innerText="该用户名可用";
                        }
                        else document.getElementsByClassName("usename")[0].innerText="用户名格式不正确";
                    }
                    else document.getElementsByClassName("usename")[0].innerText="用户名格式不正确";
                }
            };

//            一、get方法
//            xhr.open("get","renwu24_3.php?usename="+document.getElementById("usename").value,true);
//            xhr.send(null);
//            二、post方法
            var  data="usename="+document.getElementById("usename").value;
            xhr.open("post","renwu24_3.php",true);
            xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");
            xhr.send(data);

        });
        document.querySelector('#password').addEventListener('change', function(){
                    var passwordStr=document.getElementById("password").value.toString();
                    if (5< passwordStr.length && passwordStr.length<16){
                        if (passwordStr.match(/^\w{6,15}$/)){
                            if ( passwordStr.match(/[0-9]/)&&(!passwordStr.match(/[A-Z]/))&&(!passwordStr.match(/[_]/))&&(!passwordStr.match(/[a-z]/))){  document.getElementsByClassName("password")[0].innerText="请输入至少两种以上字符" }
                            if ( !passwordStr.match(/[0-9]/)&&(passwordStr.match(/[A-Z]/))&&(!passwordStr.match(/[_]/))&&(!passwordStr.match(/[a-z]/))){  document.getElementsByClassName("password")[0].innerText="请输入至少两种以上字符" }
                            if ( !passwordStr.match(/[0-9]/)&&(!passwordStr.match(/[A-Z]/))&&(passwordStr.match(/[_]/))&&(!passwordStr.match(/[a-z]/))){  document.getElementsByClassName("password")[0].innerText="请输入至少两种以上字符" }
                            if ( !passwordStr.match(/[0-9]/)&&(!passwordStr.match(/[A-Z]/))&&(!passwordStr.match(/[_]/))&&(passwordStr.match(/[a-z]/))){  document.getElementsByClassName("password")[0].innerText="请输入至少两种以上字符" }
                            else  document.getElementsByClassName("password")[0].innerText="你输入的密码可用"
                        }
                        else  document.getElementsByClassName("password")[0].innerText="您输入的含有非字母数字下划线"
                    }
                    else  document.getElementsByClassName("password")[0].innerText="您输入的密码长度过长或过短！"
        });

        document.querySelector('#password_agin').addEventListener('change', function(){
                   var passwordStr=document.getElementById("password_agin").value.toString();
                    if (passwordStr!=document.getElementById("password").value.toString()){
                        document.getElementsByClassName("password_agin")[0].innerText="您两次输入的密码不一致！"

                    }
                    else document.getElementsByClassName("password_agin")[0].innerText="两次输入的密码一致"
        });
        document.getElementById("submit").addEventListener("click",function (e) {
            e.preventDefault();
            if (document.getElementsByClassName("usename")[0].innerText!=="该用户名可用"||
                document.getElementsByClassName("password")[0].innerText!=="你输入的密码可用"||
                document.getElementsByClassName("password_agin")[0].innerText!=="两次输入的密码一致") 
                {                    
                    alert("请输入正确且完整的信息！");
                }
            else { alert("请稍等正在注册~") }
        });

    </script>

</body>
</html>